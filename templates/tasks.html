<script>
    $(document).ready(function(){
        $(".fa-trash").click(function(){
            if(confirm('Are you sure to delete?')){
                location.replace($(this).data('link'));
            }
        });

        $("input[type='checkbox']").click(function(){
            checklist = [];
            $("input[type='checkbox']").each(function(){
                checklist.push($(this).prop("checked"));
            });


            topic = $("h2").text();

            $.ajax({
            url: "/check_handler",
            type: "get",
            data: {jsdata: checklist},
            success: function(response) {
                $(".container").html(response);
            },
            error: function(xhr) {
                //Do Something to handle error
            }
            });

        });

    });
</script>
    <h2>{{topic}}</h2>
    <hr>
    <p><a href="/new_entry/{{topic}}">add new entry</a></p>

    {% if entries %}
    {% set count = namespace(value=0) %}
    {% for entry in entries %}
<div class="card mb-5">

    <div class="card-header">

        <h3>{{entry.date.strftime('%b %d, %Y %H:%M')}}

            <div class="float-right">
                <a href="/edit_entry/{{topic}}/{{entry.sno}}"><button data-toggle="tooltip" data-placement="top" title="edit entry" class="fa fa-edit btn btn-info"></button></a>

                <button data-toggle="tooltip" data-placement="top" title="delete entry" data-link="/delete/{{topic}}/{{entry.sno}}" class="fa fa-trash btn btn-danger"></button>
                {% if topic == 'Tasks' %}
                <a href="/reassign_tasks/{{topic}}/{{entry.sno}}"><button data-toggle="tooltip" data-placement="top" title="reassign tasks" class="fa fa-refresh btn btn-success"></button></a>
                {% endif %}

            </div>
        </h3>
    </div>
    <div class="card-body">
        {% if topic == 'Tasks' %}
        {%for entry in entry.entries|split%}
        {% if checklist[count.value] == 'true' %}
        <input type="checkbox" checked> 
        {% else %}
        <input type="checkbox"> 
        {% endif %}
        {{ entry+'<br>'|safe }}
        {% set count.value = count.value + 1 %}
        {% endfor %}
        {% else %}
        {{entry.entries|markdown|safe}}
        {% endif %}
    </div>
</div>
    {% endfor %}
    {% else %}
    <li>
        There are no entries for this topic yet.
    </li>
    {% endif %}

